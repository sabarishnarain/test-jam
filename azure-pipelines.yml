trigger: 
  - master

pr:
  - master

resources:
  containers:
  - container: docker-node # reusable alias
    image: node:10.16-stretch

jobs:
 - job : build
   displayName: build & test
   container: docker-node
   steps: 
   - task: UseDotNet@2
     displayName: 'Use .NET Core sdk'
     inputs:
       packageType: sdk
       version: 2.2.203
       installationPath: $(Agent.ToolsDirectory)/dotnet
   - script: npm i
     displayName: install
   - script: npm run lint
     displayName: lint
   - script: npm run test-ci
     displayName: test-unit
   - task: PublishTestResults@2
     condition: succeededOrFailed()
     inputs:
       testRunner: JUnit
       testResultsFiles: '**/test-results.xml'
       failTaskOnFailedTests: true # Fail the task if there are test failures
   - task: PublishCodeCoverageResults@1
     inputs: 
       codeCoverageTool: Cobertura
       summaryFileLocation: '$(System.DefaultWorkingDirectory)/**/*coverage.xml'
       reportDirectory: '$(System.DefaultWorkingDirectory)/**/coverage'
    